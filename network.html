<!DOCTYPE html>
<html lang="en-GB">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Artfictions – Theme‑Novel Network</title>
  <!-- typeface + external main stylesheet for typography colours etc. -->
  <link rel="preconnect" href="https://fonts.gstatic.com" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />
  <!-- vis‑network library -->
  <link rel="stylesheet" href="https://unpkg.com/vis-network@9.1.2/dist/vis-network.min.css" />
  <script src="https://unpkg.com/vis-network@9.1.2/dist/vis-network.min.js"></script>
  <style>
    /* override: we only need a centred graph container here */
    #graph{height:600px;border:1px solid #ddd;border-radius:6px;margin-top:1.5rem}
  </style>
</head>
<body>
<main style="max-width:1100px;margin:auto">
  <h1 style="margin-bottom:.5rem">Novel–Theme Network</h1>
  <p style="font-size:.9rem;margin:0 0 1rem 0">Interactive force‑directed graph of all novels and their associated themes. Drag to explore, scroll to zoom.</p>
  <p style="font-size:.9rem"><a href="index.html" style="text-decoration:underline">← Back to catalogue</a></p>
  <div id="graph"></div>
</main>

<script>
(async function(){
  const DATA_URL='artfictions_novels.json';
  const container=document.getElementById('graph');
  let raw;
  try{
    const res=await fetch(DATA_URL);
    if(!res.ok) throw new Error(res.status);
    raw=await res.json();
  }catch(e){container.innerHTML='<p style="color:#b00">Failed to load dataset</p>';return;}
  if(!Array.isArray(raw)){
    const key=Object.keys(raw).find(k=>Array.isArray(raw[k]));
    raw=key?raw[key]:[];
  }

  /* prepare nodes + edges */
  const nodes=[],edges=[],themeId={};
  let id=1;
  raw.forEach(n=>{
    const nId=id++;
    nodes.push({id:nId,label:n.Title,shape:'dot',color:'#0a84ff',size:8});
    const themes=[];
    for(let i=1;i<=5;i++){const k=`Theme ${i}`;if(n[k])themes.push(n[k].trim());}
    themes.forEach(t=>{
      if(!themeId[t]){themeId[t]=id++;nodes.push({id:themeId[t],label:t,shape:'box',color:'#666'});} 
      edges.push({from:nId,to:themeId[t]});
    });
  });

  const data={nodes:new vis.DataSet(nodes),edges:new vis.DataSet(edges)};
  const options={physics:{barnesHut:{damping:0.3}},layout:{improvedLayout:true},interaction:{hover:true}};
  new vis.Network(container,data,options);
})();
</script>
</body>
</html>
